

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting &amp; Installing the DAGMC Toolkit &mdash; DAGMC</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="DAGMC" href="../../index.html" />
    <link rel="up" title="DAGMC User’s Guide" href="index.html" />
    <link rel="next" title="Using DAGMC - The DAGMC Workflow" href="workflow.html" />
    <link rel="prev" title="DAGMC User’s Guide" href="index.html" /> 
  </head>
  <body> 
<div id="page-div" class="page">
<div id="header"><a id="uwhome" href="http://www.wisc.edu"><img src="/DAGMC/_static/images/wordmark.gif" alt="University of Wisconsin–Madison" width="260" height="11" /></a> <a id="crest" href="http://www.wisc.edu"><img src="/DAGMC/_static/images/crest.png" alt="" width="70" height="106" /></a>
    <h1 id="siteTitle"><a href="/"><span>DAGMC</span></a></h1>
    <div id="tagline"><span>Direct Accelerated Geometry Monte Carlo Toolkit</span></div>
    <ul id="globalnav">
      <li id="uwsearch"><a href="http://www.wisc.edu/search/">UW Search</a></li>
      <li><a href="http://cnerg.github.com">CNERG</a></li>
      <li><a href="http://my.wisc.edu">My UW</a></li>
      <li><a href="http://map.wisc.edu">Map</a></li>
      <li id="last_tool"><a href="http://www.today.wisc.edu">Calendar</a></li>
    </ul>
    <form role="search" action="../../search.html" method="get" id="cse-search-box">
      <div>
      <label class="screen-reader-text" for="q">Search for:</label>
      <input type="text" id="q" name="q" value="Enter keywords here...." />
      <input type="submit" id="sa" value="Search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
      </div>
    </form>
<script type="text/javascript">$('#searchbox').show(0);</script>
</div>

    <div id="nav" class="main-menu-container">
      <ul id="menu-main" class="sf-menu">
        <li class="menu-item"><a href="../../index.html">DAGMC</a></li>
        <li class="menu-item" style="margin-right: 10px">
          <a href="index.html" title="DAGMC User’s Guide"
             accesskey="P">previous</a>
          </li>
        <li class="menu-item" >
          <a href="workflow.html" title="Using DAGMC - The DAGMC Workflow"
             accesskey="N">next</a>
          </li>
        <li class="menu-item" >
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a>
          </li>
          <li class="menu-item"><a href="index.html" accesskey="U">DAGMC User&#8217;s Guide</a></li> 
      </ul>
    </div>
  <div id="c_container"> 
<div id="sidebar">
 <div id="sidebar_section"></div>
 <div id="sidebar_section"><strong>Table of Contents</strong><br><ul>
<li><a class="reference internal" href="#">Getting &amp; Installing the DAGMC Toolkit</a><ul>
<li><a class="reference internal" href="#dagmc-dependencies-and-user-workflows">DAGMC Dependencies and User Workflows</a><ul>
<li><a class="reference internal" href="#manual-geometry-preparation">Manual Geometry Preparation</a></li>
<li><a class="reference internal" href="#automated-model-pre-processing">Automated Model Pre-processing</a></li>
<li><a class="reference internal" href="#model-analysis">Model Analysis</a></li>
<li><a class="reference internal" href="#summary-of-dependencies">Summary of Dependencies</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installing-the-dagmc-toolkit">Installing the DAGMC Toolkit</a></li>
<li><a class="reference internal" href="#applying-dagmc-to-specific-monte-carlo-codes">Applying DAGMC to Specific Monte Carlo Codes</a></li>
</ul>
</li>
</ul>
 </div>
</div> 
    <div id="content" class="inline-block">
          <div class="post">
            
  <div class="section" id="getting-installing-the-dagmc-toolkit">
<h1>Getting &amp; Installing the DAGMC Toolkit<a class="headerlink" href="#getting-installing-the-dagmc-toolkit" title="Permalink to this headline">¶</a></h1>
<p>DAGMC is a toolkit that provides direct geometry support to any Monte
Carlo radiation transport code.  The primary code used for development
and testing of DAGMC is <a class="reference external" href="http://mcnp-green.lanl.gov/">MCNP5</a>,
developed by <a class="reference external" href="http://www.lanl.gov">Los Alamos National Laboratory</a>
and distributed by the <a class="reference external" href="http://rsicc.ornl.gov">Radiation Safety Information Computing Center</a>.  There has also been experience with MCNPX
(LANL) and Tripoli4 (CEA/Saclay).</p>
<p>These instructions describe the basic steps for downloading and
installing the software libraries that provide the DAGMC toolkit for
integration with Monte Carlo codes.  After this, code-specific
instructions will be give for each code.</p>
<div class="section" id="dagmc-dependencies-and-user-workflows">
<h2>DAGMC Dependencies and User Workflows<a class="headerlink" href="#dagmc-dependencies-and-user-workflows" title="Permalink to this headline">¶</a></h2>
<p>It is useful to consider how users will use the DAGMC workflow prior
to making some installation decisions.  There are three main stages
for the workflow:</p>
<blockquote>
<div><ul class="simple">
<li>manual preparation of geometric models</li>
<li>automated pre-processing of models</li>
<li>use of the models in analysis</li>
</ul>
</div></blockquote>
<p>While the second and third stages can be combined, these instructions
will be based on treating them as separate stages with comments about
how they would be combined where appropriate.</p>
<div class="section" id="manual-geometry-preparation">
<h3>Manual Geometry Preparation<a class="headerlink" href="#manual-geometry-preparation" title="Permalink to this headline">¶</a></h3>
<p>Because this stage is highly interactive, most users prefer to perform
this stage on their desktop or laptop computer.  The only software
required for this stage is the interactive Cubit software.</p>
</div>
<div class="section" id="automated-model-pre-processing">
<h3>Automated Model Pre-processing<a class="headerlink" href="#automated-model-pre-processing" title="Permalink to this headline">¶</a></h3>
<p>The primary purpose of this stage is to &#8220;translate&#8221; from the solid
model representation to the faceted representation.  As such, it
requires Cubit, CGM and MOAB, and typically results in dependencies on
shared libraries.</p>
</div>
<div class="section" id="model-analysis">
<h3>Model Analysis<a class="headerlink" href="#model-analysis" title="Permalink to this headline">¶</a></h3>
<p>During analysis, only the faceted model is necessary, requiring only
MOAB and the physics code.  It is also possible to combine this stage
with the previous one, requiring Cubit, CGM, MOAB and the physics
code, and will also result in dependencies on shared libraries.</p>
</div>
<div class="section" id="summary-of-dependencies">
<h3>Summary of Dependencies<a class="headerlink" href="#summary-of-dependencies" title="Permalink to this headline">¶</a></h3>
<ul>
<li><dl class="first docutils">
<dt>Some physics package, e.g. MCNP5</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt><a class="reference external" href="http://trac.mcs.anl.gov/projects/ITAPS/wiki/MOAB">MOAB/DAGMC</a></dt>
<dd><ul class="first last">
<li><p class="first"><a class="reference external" href="http://www.hdfgroup.org/HDF5/release/obtain5.html">HDF5</a></p>
</li>
<li><dl class="first docutils">
<dt><a class="reference external" href="http://trac.mcs.anl.gov/projects/ITAPS/wiki/CGM">CGM</a></dt>
<dd><ul class="first last simple">
<li>ACIS v19, or <a class="reference external" href="http://cubit.sandia.gov">CUBIT</a> v12.2</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
</div>
<div class="section" id="installing-the-dagmc-toolkit">
<h2>Installing the DAGMC Toolkit<a class="headerlink" href="#installing-the-dagmc-toolkit" title="Permalink to this headline">¶</a></h2>
<p>The following 4 steps are required to install the MOAB library,
including the DAGMC toolkit, for use in Monte Carlo radiation
transport tools.  Following these steps, all the pre-requisites for
the automated processing stage will be available.</p>
<ol class="arabic simple">
<li>Install <a class="reference external" href="http://cubit.sandia.gov">CUBIT</a> v12.2</li>
<li>Install <a class="reference external" href="http://trac.mcs.anl.gov/projects/ITAPS/wiki/CGM">CGM</a>, using the &#8211;with-cubit options</li>
<li>Install <a class="reference external" href="http://www.hdfgroup.org/HDF5/">HDF5</a></li>
<li>Install <a class="reference external" href="http://trac.mcs.anl.gov/projects/ITAPS/wiki/MOAB">MOAB</a>,
using the &#8211;with-cgm and &#8211;with-hdf5 options (&#8211;with-netcdf may
also be useful but not necessary)</li>
</ol>
<p>Here are some assumptions/conventions that are used in these instructions:</p>
<ul class="simple">
<li>all operations are carried out in the a subdirectory <tt class="docutils literal"><span class="pre">dagmc_bld</span></tt> of a user&#8217;s home directory</li>
<li>path to CUBIT files is known, e.g. <tt class="docutils literal"><span class="pre">/path/to/cubit</span></tt></li>
<li>all tarballs reside in user&#8217;s home directory</li>
</ul>
<p>If these do not apply to you, please modify your steps accordingly.</p>
<blockquote>
<div><em>(For a shortcut to installing DAG-MCNP5.1.51 you may be able to use the DagmcBuildPackage .)</em></div></blockquote>
<p>Create a directory to build CGM:</p>
<div class="highlight-python"><pre>prompt%&gt; mkdir -p $HOME/dagmc_bld/CGM/bld
prompt%&gt; cd $HOME/dagmc_bld/CGM</pre>
</div>
<p>If installing from SVN repository:</p>
<div class="highlight-python"><pre>prompt%&gt; svn co https://svn.mcs.anl.gov/repos/ITAPS/cgm/trunk
prompt%&gt; cd trunk
prompt%&gt; autoreconf -fi
prompt%&gt; cd ..
prompt%&gt; ln -s trunk src</pre>
</div>
<p>If installing from a tarball, <tt class="docutils literal"><span class="pre">CGM-12.2.0.tar.gz</span></tt>:</p>
<div class="highlight-python"><pre>prompt%&gt; tar xzf ~/CGM-12.2.0.tar.gz
prompt%&gt; ln -s CGM-12.2.0 src</pre>
</div>
<p>In all cases:</p>
<div class="highlight-python"><pre>prompt%&gt; cd bld
prompt%&gt; ../src/configure --enable-optimize --disable-debug \
          --with-cubit=/path/to/cubit  \
          --prefix=$HOME/dagmc_bld/CGM
prompt%&gt; make
prompt%&gt; make install</pre>
</div>
<p>Follow these steps</p>
<div class="highlight-python"><pre>prompt%&gt; mkdir $HOME/dagmc_bld/HDF5/bld
prompt%&gt; cd $HOME/dagmc_bld/HDF5
prompt%&gt; tar xzf ~/hdf5-1.8.3.tar.gz
prompt%&gt; ln -s hdf5-1.8.3 src
prompt%&gt; cd bld
prompt%&gt; ../src/configure --prefix=$HOME/dagmc_bld/HDF5
prompt%&gt; make
prompt%&gt; make install</pre>
</div>
<p>Create a directory to install MOAB:</p>
<div class="highlight-python"><pre>prompt%&gt; mkdir -p $HOME/dagmc_bld/MOAB/bld
prompt%&gt; cd $HOME/dagmc_bld/MOAB</pre>
</div>
<p>If installing from SVN repository:</p>
<div class="highlight-python"><pre>prompt%&gt; svn co https://svn.mcs.anl.gov/repos/ITAPS/MOAB/trunk
prompt%&gt; cd trunk
prompt%&gt; autoreconf -fi
prompt%&gt; cd ..
prompt%&gt; ln -s trunk src</pre>
</div>
<p>If installing from a tarball, <tt class="docutils literal"><span class="pre">MOAB-3.99.tar.gz</span></tt>:</p>
<div class="highlight-python"><pre>prompt%&gt; tar xzf ~/MOAB-3.99.tar.gz
prompt%&gt; ln -s MOAB-3.99 src</pre>
</div>
<p>In all cases:</p>
<div class="highlight-python"><pre>prompt%&gt; cd bld
prompt%&gt; ../src/configure --enable-optimize --disable-debug \
          --with-cgm=$HOME/dagmc_bld/CGM  \
          --with-hdf5=$HOME/dagmc_bld/HDF5 \
          --prefix=$HOME/dagmc_bld/MOAB
prompt%&gt; make
prompt%&gt; make install</pre>
</div>
</div>
<div class="section" id="applying-dagmc-to-specific-monte-carlo-codes">
<h2>Applying DAGMC to Specific Monte Carlo Codes<a class="headerlink" href="#applying-dagmc-to-specific-monte-carlo-codes" title="Permalink to this headline">¶</a></h2>
<p>If you would like to use DAGMC with MCNP5, known as DAG-MCNP5, you will also need:</p>
<ul class="simple">
<li>MCNP5.1.51 source code from <a class="reference external" href="http://rsicc.ornl.gov">RSICC</a></li>
<li>DAG-MCNP5.1.51 patch file from the UW-Madison</li>
</ul>
<p>A package has been prepared that includes many of the requires
software libraries and an automated build script.  Because the DAGMC
team is not authorized to distribute <a class="reference external" href="http://cubit.sandia.gov">CUBIT</a> nor <a class="reference external" href="http://mcnp.lanl.gov">MCNP5.1.51 source code</a>, you must acquire those through the
appropriate channels on your own.</p>
<p>Once you have both of those things, you should be able to use the
DagmcBuildPackage to create a working install of DAG-MCNP5.1.51.</p>
<p>The following steps are required to install DAG-MCNP5.  Most of these steps are described in more detail below.</p>
<ol class="arabic">
<li><p class="first">Install the DAGMC Toolkit as described above</p>
</li>
<li><dl class="first docutils">
<dt>Download a copy of the patch file for your version of MCNP:</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="https://raw.github.com/svalinn/DAGMC/master/patch/dagmc.patch.5.1.60">MCNP5 v1.60</a></li>
<li><a class="reference external" href="https://raw.github.com/svalinn/DAGMC/master/patch/dagmc.patch.5.1.51">MCNP5 v1.51</a></li>
<li><a class="reference external" href="https://raw.github.com/svalinn/DAGMC/master/patch/dagmc.patch.5.1.40">MCNP4 v1.40</a></li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Apply the patch your copy of the MCNP5.1.60 (or appropriate
version) source code</p>
</li>
<li><p class="first">Build &amp; install the patched version of MCNP5</p>
</li>
</ol>
<p>Some assumptions/conventions:</p>
<ul class="simple">
<li>all operations are carried out in the a subdirectory <tt class="docutils literal"><span class="pre">dagmc_bld</span></tt> of a user&#8217;s home directory</li>
<li>path to CUBIT files is known, e.g. <tt class="docutils literal"><span class="pre">/path/to/cubit</span></tt></li>
<li>all tarballs reside in user&#8217;s home directory</li>
<li>MCNP5 source code is available in location <tt class="docutils literal"><span class="pre">$HOME/dagmc_bld/MCNP5</span></tt></li>
</ul>
<p>Perform the following steps:</p>
<div class="highlight-python"><pre>prompt%&gt; cd $HOME/dagmc_bld/MCNP5/Source
prompt%&gt; patch -p 0 &lt; ~/dagmc_install.patch.5.1.60</pre>
</div>
<p>One of the easiest ways to build DAG-MCNP5 is directly using the
<tt class="docutils literal"><span class="pre">makefile</span></tt> from the command-line.  To do this, you must know the
<tt class="docutils literal"><span class="pre">makefile</span></tt> options to build a version of MCNP5 without DAGMC,
usually in the form:</p>
<div class="highlight-python"><pre>prompt%&gt; make build CONFIG="seq plot gfortran" FC=gfortran MARCH=M64``</pre>
</div>
<p>or similar.  Starting from these options, you can build DAG-MCNP5 from
a patched source code with:</p>
<div class="highlight-python"><pre>prompt%&gt; make build CONFIG="seq plot gfortran dagmc" FC=gfortran MARCH=M64 \
             MOAB_DIR=$HOME/dagmc_bld/MOAB CUBIT_DIR=/path/to/cubit/bin</pre>
</div>
<p>If you are less familiar with building MCNP5 from the <tt class="docutils literal"><span class="pre">makefile</span></tt> you
may want to use the interactive <tt class="docutils literal"><span class="pre">install</span></tt> script provided by LANL:</p>
<div class="highlight-python"><pre>prompt%&gt; ./install</pre>
</div>
<p>Within the <tt class="docutils literal"><span class="pre">install</span></tt> program you will need to set the DAGMC build options:</p>
<ul class="simple">
<li>turn on DAGMC mode</li>
<li>provide the path to MOAB: <tt class="docutils literal"><span class="pre">$HOME/dagmc_bld/MOAB</span></tt></li>
<li>provide the path to CUBIT: <tt class="docutils literal"><span class="pre">/path/to/cubit</span></tt></li>
</ul>
<p>From the main menu, choose <tt class="docutils literal"><span class="pre">C</span></tt> to compile.</p>
<p>Your executable should be available as <tt class="docutils literal"><span class="pre">$HOME/dagmc_bld/MCNP5/Source/src/mcnp5</span></tt>.</p>
<p>Tripoli4 is distributed by CEA/Saclay as a binary executable.  For
access to DAG-Tripoli4, please contact <a class="reference external" href="mailto:jean-christophe&#46;trama&#37;&#52;&#48;cea&#46;fr">Jean-Christophe Trama</a>.</p>
</div>
</div>


          </div>
      </div>

    </div>
</div>
    <div id="footer">
      <p>
        &copy; Copyright 2012, The UW CNERG Team.
      </p>
      <p>
      Last updated on Oct 08, 2012.
      </p>
      <p>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
      </p>
    </div>
  </body>
</html>