
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Installing the DAGMC Toolkit &mdash; DAGMC</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="DAGMC" href="../index.html" />
    <link rel="up" title="DAGMC User’s Guide" href="index.html" />
    <link rel="next" title="Using DAGMC - The DAGMC Workflow" href="workflow.html" />
    <link rel="prev" title="DAGMC Quick Start Guide" href="quick_start.html" /> 
  </head>
  <body> 
<div id="page-div" class="page">
<div id="header"><a id="uwhome" href="http://www.wisc.edu"><img src="/DAGMC/_static/images/wordmark.gif" alt="University of Wisconsin–Madison" width="260" height="11" /></a> <a id="crest" href="http://www.wisc.edu"><img src="/DAGMC/_static/images/crest.png" alt="" width="70" height="106" /></a>
    <h1 id="siteTitle"><a href="/"><span>DAGMC</span></a></h1>
    <div id="tagline"><span>Direct Accelerated Geometry Monte Carlo Toolkit</span></div>
    <ul id="globalnav">
      <li id="uwsearch"><a href="http://www.wisc.edu/search/">UW Search</a></li>
      <li><a href="http://cnerg.github.com">CNERG</a></li>
      <li><a href="http://my.wisc.edu">My UW</a></li>
      <li><a href="http://map.wisc.edu">Map</a></li>
      <li id="last_tool"><a href="http://www.today.wisc.edu">Calendar</a></li>
    </ul>
    <form role="search" action="../search.html" method="get" id="cse-search-box">
      <div>
      <label class="screen-reader-text" for="q">Search for:</label>
      <input type="text" id="q" name="q" value="Enter keywords here...." />
      <input type="submit" id="sa" value="Search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
      </div>
    </form>
<script type="text/javascript">$('#searchbox').show(0);</script>
</div>

    <div id="nav" class="main-menu-container">
      <ul id="menu-main" class="sf-menu">
        <li class="menu-item"><a href="../index.html">DAGMC</a></li>
        <li class="menu-item" style="margin-right: 10px">
          <a href="quick_start.html" title="DAGMC Quick Start Guide"
             accesskey="P">previous</a>
          </li>
        <li class="menu-item" >
          <a href="workflow.html" title="Using DAGMC - The DAGMC Workflow"
             accesskey="N">next</a>
          </li>
        <li class="menu-item" >
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
          </li>
          <li class="menu-item"><a href="index.html" accesskey="U">DAGMC User&#8217;s Guide</a></li> 
      </ul>
    </div>
  <div id="c_container"> 
<div id="sidebar">
 <div id="sidebar_section"></div>
 <div id="sidebar_section"><strong>Table of Contents</strong><br><ul>
<li><a class="reference internal" href="#">Installing the DAGMC Toolkit</a><ul>
<li><a class="reference internal" href="#toolkit-installation">Toolkit Installation</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#building">Building</a><ul>
<li><a class="reference internal" href="#id4">CGM</a></li>
<li><a class="reference internal" href="#id5">HDF5</a></li>
<li><a class="reference internal" href="#id6">MOAB</a></li>
<li><a class="reference internal" href="#id7">PyNE</a></li>
</ul>
</li>
<li><a class="reference internal" href="#post-install">Post Install</a></li>
</ul>
</li>
<li><a class="reference internal" href="#toolkit-applications">Toolkit Applications</a><ul>
<li><a class="reference internal" href="#install-fluka">Install FLUKA</a></li>
<li><a class="reference internal" href="#install-geant4">Install Geant4</a></li>
<li><a class="reference internal" href="#build-dagmc-interfaces">Build DAGMC Interfaces</a><ul>
<li><a class="reference internal" href="#populate-and-patch">Populate and Patch</a></li>
<li><a class="reference internal" href="#configure-and-build-dagmc">Configure and build DAGMC</a></li>
</ul>
</li>
<li><a class="reference internal" href="#compile-and-install">Compile and Install</a></li>
<li><a class="reference internal" href="#testing">Testing</a></li>
<li><a class="reference internal" href="#dag-tripoli4-access">DAG-Tripoli4 Access</a></li>
</ul>
</li>
</ul>
</li>
</ul>
 </div>
</div> 
    <div id="content" class="inline-block">
          <div class="post">
            
  <div class="section" id="installing-the-dagmc-toolkit">
<h1>Installing the DAGMC Toolkit<a class="headerlink" href="#installing-the-dagmc-toolkit" title="Permalink to this headline">¶</a></h1>
<p>DAGMC is a toolkit that provides direct geometry support to any Monte
Carlo radiation transport code. These instructions describe the basic
steps for downloading and installing the software libraries that provide
the DAGMC toolkit for integration with Monte Carlo codes.  After this,
code-specific instructions will be give for each code.</p>
<div class="section" id="toolkit-installation">
<h2>Toolkit Installation<a class="headerlink" href="#toolkit-installation" title="Permalink to this headline">¶</a></h2>
<p>This section details the installation and build steps for the prerequisite
packages for the the DAGMC toolkit with specific physics codes.</p>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<p>In order to install you must have done the following:</p>
<blockquote>
<div><ul class="simple">
<li>Cloned the <a class="reference external" href="http://github.com/svalinn/DAGMC">DAGMC</a> repository</li>
<li>Installed <a class="reference external" href="http://www.hdfgroup.org/HDF5/">HDF5</a></li>
<li>Install <a class="reference external" href="http://trac.mcs.anl.gov/projects/ITAPS/wiki/CGM">CGM</a>, using the &#8211;with-cubit option</li>
<li>Installed <a class="reference external" href="http://trac.mcs.anl.gov/projects/ITAPS/wiki/MOAB">MOAB</a>,
using options &#8211;with-cgm &#8211;with-hdf5 &#8211;with-dagmc &#8211;without-netcdf
If you need to prepare meshed geometries the following are also required
a) Install <a class="reference external" href="http://cubit.sandia.gov">CUBIT</a> v12.2 or v13.1</li>
<li>Installed Lapack.  __Note:__ the MCNP build automatically builds the dagtally library, which requires Lapack</li>
<li>Installed <a class="reference external" href="http://www.fluka.org/fluka.php">FLUKA</a> - and/or -</li>
<li>Installed <a class="reference external" href="http://geant4.cern.ch/">Geant4</a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="building">
<h3>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h3>
<p>With installation of the DAGMC Toolkit, the dependency stack will look like this:</p>
<ul>
<li><dl class="first docutils">
<dt>Some physics package, e.g. MCNP5, Geant4 etc</dt>
<dd><ul class="first last">
<li><p class="first"><a class="reference external" href="http://bitbucket.org/fathomteam/moab">MOAB/DAGMC</a></p>
</li>
<li><p class="first"><a class="reference external" href="http://pyne.io/install.html">PyNE</a></p>
</li>
<li><p class="first"><a class="reference external" href="http://www.hdfgroup.org/HDF5/release/obtain5.html">HDF5</a></p>
</li>
<li><dl class="first docutils">
<dt><a class="reference external" href="http://bitbucket.org/fathomteam/cgm">CGM</a></dt>
<dd><ul class="first last simple">
<li>ACIS v19, or <a class="reference external" href="http://cubit.sandia.gov">CUBIT</a> v12.2 or v13.1</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Assumptions and conventions that are used in these instructions:</p>
<ul class="simple">
<li>all operations are carried out in the a subdirectory <tt class="docutils literal"><span class="pre">dagmc_bld</span></tt> of a user&#8217;s home directory</li>
<li>the path to CUBIT files is known, e.g. <tt class="docutils literal"><span class="pre">/path/to/cubit</span></tt>.  This is the directory that contains the Python script file <tt class="docutils literal"><span class="pre">cubit</span></tt> and a <tt class="docutils literal"><span class="pre">bin</span></tt> subdirectory.</li>
</ul>
<p>If these do not apply to you, please modify your steps accordingly.</p>
<blockquote>
<div><em>(For a shortcut to installing DAG-MCNP5.1.60 you may be able to use the build_dagmc_stack.bash script .)</em></div></blockquote>
<div class="section" id="id4">
<h4>CGM<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Create a CGM directory to build in:</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; mkdir -p $HOME/dagmc_bld/CGM/bld
prompt%&gt; cd $HOME/dagmc_bld/CGM
</pre></div>
</div>
<p>If you are building CGM with Cubit v13.1 or v12.2 you <em>must</em> clone the cgm repository using, respectively, one of the following methods:</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; git clone https://bitbucket.org/fathomteam/cgm/
prompt%&gt; cd cgm
prompt%&gt; git checkout 13.1.1
prompt%&gt; autoreconf -fi
prompt%&gt; cd ..
prompt%&gt; ln -s cgm src
</pre></div>
</div>
<p>-or-</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; git clone https://bitbucket.org/fathomteam/cgm/
prompt%&gt; cd cgm
prompt%&gt; git checkout 12.2.2
prompt%&gt; autoreconf -fi
prompt%&gt; cd ..
prompt%&gt; ln -s cgm src
</pre></div>
</div>
<p>Configure and build CGM:</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; cd bld
prompt%&gt; ../src/configure --enable-optimize \
          --enable-shared --disable-debug \
          --with-cubit=/path/to/cubit  \
          --prefix=$HOME/dagmc_bld/CGM
prompt%&gt; make
prompt%&gt; make install
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h4>HDF5<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>Debian users may conveniently install the latest HDF5 release with the command:</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; sudo apt-get install hdf5-dev
</pre></div>
</div>
<p>Fedora users can do likewise with this command:</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; sudo yum install hdf5-dev
</pre></div>
</div>
<p>The HDF5 tarball can also be downloaded from the HDF5 <a class="reference external" href="http://www.hdfgroup.org/HDF5/release/obtain5.html">website</a>.  On a Linux machine the wget command may be used to get the most recent release, which is currently hdf5-1.8.13:</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; wget \
http://www.hdfgroup.org/ftp/HDF5/releases/hdf5-1.8.13/src/hdf5-1.8.13.tar.gz
</pre></div>
</div>
<p>See the <a class="reference external" href="http://www.hdfgroup.org/ftp/HDF5/releases">HDF5 ftp site</a> for available versions.</p>
<p>In the case of a tarball, create a directory and install HDF5:</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; mkdir -p $HOME/dagmc_bld/HDF5/bld
prompt%&gt; cd $HOME/dagmc_bld/HDF5
prompt%&gt; tar xzf ~/hdf5-1.8.13.tar.gz
prompt%&gt; ln -s hdf5-1.8.13 src
prompt%&gt; cd bld
prompt%&gt; ../src/configure --enable-shared --prefix=$HOME/dagmc_bld/HDF5
prompt%&gt; make
prompt%&gt; make install
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h4>MOAB<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>The master branch of MOAB is currently at version 4.7.0, which is the earliest version that may be used.</p>
<p>Create a MOAB directory to install in</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; mkdir -p $HOME/dagmc_bld/MOAB/bld
prompt%&gt; cd $HOME/dagmc_bld/MOAB
</pre></div>
</div>
<p>If installing MOAB from the git repository:</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; git clone https://bitbucket.org/fathomteam/moab/
prompt%&gt; cd moab
prompt%&gt; git checkout master
prompt%&gt; autoreconf -fi
prompt%&gt; cd ..
prompt%&gt; ln -s moab src
</pre></div>
</div>
<p>The command to &#8220;git checkout master&#8221; is, in general, redundant but is included here for completeness.</p>
<p>In all MOAB cases:</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; cd bld
prompt%&gt; ../src/configure --enable-optimize \
          --enable-shared --disable-debug \
          --with-cgm=$HOME/dagmc_bld/CGM  \
          --with-hdf5=$HOME/dagmc_bld/HDF5 \
          --enable-dagmc \
          --prefix=$HOME/dagmc_bld/MOAB
prompt%&gt; make
prompt%&gt; make install
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h4>PyNE<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="http://pyne.io">PyNE</a> is a Python-wrapped C++ library which contains many functions
that are very useful to scientists and engineers performing radiation transport calculations.
We now include an amalgamated build of the key C++ parts of PyNE to avoid building and downloading
PyNE. Whilst no longer a dependency it is highly recommended, installation instructions can be found
<a class="reference external" href="http://pyne.io/install/index.html">here</a></p>
</div>
</div>
<div class="section" id="post-install">
<h3>Post Install<a class="headerlink" href="#post-install" title="Permalink to this headline">¶</a></h3>
<p>Having installed all the prerequisite tools, namely Cubit, CGM, HDF5, and MOAB, the user
must ensure that the system has access to the libraries and programs that have been built.
Therefore modify the $PATH and $LD_LIBRARY_PATH environments accordingly:</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; export PATH=$PATH:$HOME/dagmc_bld/path/to/cubit/bin: \
                           $HOME/.local/bin: \
                           $HOME/dagmc_bld/HDF5/bin: \
                           $HOME/dagmc_bld/MOAB/bin
prompt%&gt; export LD_LIBRARY_PATH=$LD_LIBRARY_PATH: \
                           $HOME/dagmc_bld/path/to/cubit/bin: \
                           $HOME/.local/lib: \
                           $HOME/dagmc_bld/HDF5/lib: \
                           $HOME/dagmc_bld/MOAB/lib:/$HOME/dagmc_bld/CGM/lib
</pre></div>
</div>
<p>One should be able to sucessfully run the commands</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; which dagmc_preproc
prompt%&gt; which mbconvert
prompt%&gt; which h5ls
</pre></div>
</div>
<p>This is indicative of a succesful depdendency build.</p>
</div>
</div>
<div class="section" id="toolkit-applications">
<h2>Toolkit Applications<a class="headerlink" href="#toolkit-applications" title="Permalink to this headline">¶</a></h2>
<div class="section" id="install-fluka">
<h3>Install FLUKA<a class="headerlink" href="#install-fluka" title="Permalink to this headline">¶</a></h3>
<p>FluDAG uses <a class="reference external" href="http://www.fluka.org/fluka.php">FLUKA</a> from CERN/INFN with the DAGMC Toolkit.</p>
<p>In order to download FLUKA you need to become a registered user, which you can do at
the <a class="reference external" href="https://www.fluka.org/fluka.php?id=secured_intro">FLUKA register</a> page
from a link on the main FLUKA page.</p>
<p>Save the user id and password for future FLUKA updates.  We recommend an x64
worfklow and as such you should download the 64 bit executable.  The download
name is of the form <em>fluka20xx.xx-linux-gfor64bitAA.tar.gz</em>.  See the
<a class="reference external" href="http://www.fluka.org/fluka.php?id=ins_run&amp;mm2=3">site</a> for instructions.</p>
<p>Follow the FLUKA site instructions to set the FLUPRO and FLUFOR environment
variables.  Currently, you must patch FLUKA&#8217;s run script, rfluka, to allow for some DAGMC
specific options.</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; cd $FLUPRO/flutil
prompt%&gt; cp rfluka rfluka.orig
prompt%&gt; patch rfluka $HOME/dagmc_bld/DAGMC/fluka/rfluka.patch
</pre></div>
</div>
<p>Confirm that you have a working install of Fluka and proceed to the next steps.</p>
</div>
<div class="section" id="install-geant4">
<h3>Install Geant4<a class="headerlink" href="#install-geant4" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://geant4.cern.ch">Geant4</a>, a toolkit for the simulation of the passage of particles through matter, can be found
<a class="reference external" href="http://geant4.cern.ch/support/gettingstarted.shtml">here</a>,  including a link to instructions for installation. We recommend the following flags</p>
<div class="highlight-python"><div class="highlight"><pre>-DCMAKE_INSTALL_PREFIX=&lt;path to install location&gt;
-DGEANT4_INSTALL_DATA=ON
-DGEANT4_USE_QT=ON or -DGEANT4_USE_OPENGL_X11=ON
-DGEANT4_USE_SYSTEM_EXPAT=OFF
</pre></div>
</div>
</div>
<div class="section" id="build-dagmc-interfaces">
<h3>Build DAGMC Interfaces<a class="headerlink" href="#build-dagmc-interfaces" title="Permalink to this headline">¶</a></h3>
<p>The DAGMC toolkit now has a full CMake install and build method for all codes used downstream.  It even
replaces the MCNP build method with a CMake file.</p>
<p>Note that in addition to the detailed instructions above for building the MOAB stack, you may also
need to install Lapack using, for example, &#8220;sudo apt-get install liblapack-dev libblas-dev&#8221;.</p>
<div class="section" id="populate-and-patch">
<h4>Populate and Patch<a class="headerlink" href="#populate-and-patch" title="Permalink to this headline">¶</a></h4>
<p>In order to populate and patch the MCNP5 source in the DAGMC subdirectory
first copy the &#8220;Source&#8221; directory for MCNP5v16 from the LANL/RSICC CD to the
mcnp5/ directory in the DAGMC source tree</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; cd $HOME/dagmc_bld/DAGMC/mcnp5
prompt%&gt; cp -r &lt;path to cdrom&gt;/MCNP5/Source .
</pre></div>
</div>
<p>Apply the patch from the patch folder</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; patch -p1 &lt; patch/dagmc.patch.5.1.60
</pre></div>
</div>
</div>
<div class="section" id="configure-and-build-dagmc">
<h4>Configure and build DAGMC<a class="headerlink" href="#configure-and-build-dagmc" title="Permalink to this headline">¶</a></h4>
<p>Clone the DAGMC repository</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; cd $HOME/dagmc_bld
prompt%&gt; git clone https://github.com/svalinn/DAGMC
prompt%&gt; cd DAGMC
prompt%&gt; git checkout develop
</pre></div>
</div>
<p>Assuming the patch was succesfully applied, i.e. there were no warnings or
errors, we can now configure the DAGMC cmake system for the desired build.</p>
<p>The CMake system can be used to configure a build of any or all of the
following, see <a class="reference external" href="cmake_options.html">cmake options</a> for a list of all possible options,
which include</p>
<blockquote>
<div><ul class="simple">
<li>MCNP5 with or without MPI</li>
<li>GEANT4 (DagSolid)</li>
<li>FLUKA  (FluDAG)</li>
<li>TALLY (Tally interface)</li>
</ul>
</div></blockquote>
<p>You will need to include the CMAKE_INSTALL_PREFIX=install_dir option as part of the configuration.  When the
build command &#8216;make install&#8217; is invoked, libraries, executables, tests, and include files are installed in
subdirectories under install_dir.  It is common to use -DCMAKE_INSTALL_PREFIX=..&#8217;, which creates and populates
these directories one level above the build directory, that is, in the DAGMC directory.
Note that the &#8216;-D&#8217; in front of CMAKE_INSTALL_PREFIX, and all of the configuration variables, defines the variable
for the cmake system.</p>
<p>From the base level of the DAGMC repository create a build directory and navigate to it.</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; cd $HOME/dagmc_bld/DAGMC
prompt%&gt; mkdir bld
prompt%&gt; cd bld
</pre></div>
</div>
<p>In the examples, the environment variable, &#8220;INSTALL_PATH&#8221;, can point to any location
where you want the libraries ($INSTALL_PATH/lib), executables ($INSTALL_PATH/bin), and
other build products to be installed.  It is typically set to the DAGMC directory, i.e.</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; export INSTALL_PATH=$HOME/dagmc_bld/DAGMC
</pre></div>
</div>
<p><strong>Example 1:</strong>  Build the DAGMC interfaces and DAG-MCNP5</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; cmake ../. -DBUILD_MCNP5=ON -DCMAKE_INSTALL_PREFIX=$INSTALL_PATH
</pre></div>
</div>
<p><strong>Example 2:</strong>  Build MCNP5 in parallel.</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; cmake ../. -DBUILD_MCNP5=ON -DMPI_BUILD=ON \
                    -DCMAKE_INSTALL_PREFIX=$INSTALL_PATH
</pre></div>
</div>
<p><strong>Example 3:</strong>  Build MCNP5 in parallel and build the dagmc-enabled FLUKA.
Note that $FLUPRO should have been previously defined as part of the FLUKA install.</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; cmake ../. -DBUILD_MCNP5=ON -DMPI_BUILD=ON \
                    -DBUILD_FLUKA=ON -DFLUKA_DIR=$FLUPRO \
                    -DCMAKE_INSTALL_PREFIX=$INSTALL_PATH
</pre></div>
</div>
<p><strong>Example 4:</strong> Build only FluDAG.</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; cmake ../. -DBUILD_FLUKA=ON -DFLUKA_DIR=$FLUPRO \
                    -DCMAKE_INSTALL_PREFIX=$INSTALL_PATH
</pre></div>
</div>
<p><strong>Example 5:</strong>  Build MCNP, FluDAG and Geant4-enabled DAGMC.</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; cmake ../. -DBUILD_MCNP5=ON  -DMPI_BUILD=ON \
                    -DBUILD_FLUKA=ON  -DFLUKA_DIR=$FLUPRO \
                    -DBUILD_GEANT4=ON -DGEANT4_DIR=path/to/geant4 \
                    -DCMAKE_INSTALL_PREFIX=$INSTALL_PATH
</pre></div>
</div>
<p><strong>Example 6:</strong>  Build MCNP, FluDAG, Geant4-enabled DAGMC and the Tally library and tests.</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; cmake ../. -DBUILD_MCNP5=ON  -DMPI_BUILD=ON \
                    -DBUILD_FLUKA=ON  -DFLUKA_DIR=$FLUPRO \
                    -DBUILD_GEANT4=ON -DGEANT4_DIR=path/to/geant4 \
                    -DBUILD_TALLY=ON \
                    -DCMAKE_INSTALL_PREFIX=$INSTALL_PATH
</pre></div>
</div>
</div>
</div>
<div class="section" id="compile-and-install">
<h3>Compile and Install<a class="headerlink" href="#compile-and-install" title="Permalink to this headline">¶</a></h3>
<p>Assuming that the cmake step was succesful, i.e. no errors were reported, compile by issuing the make command:</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; make
</pre></div>
</div>
<p>If there were no errors, install the DAGMC suite of libraries and tools by issuing the install command:</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; make install
</pre></div>
</div>
<p>If everything was successful, you may have the mcnp5 and mainfludag executables in the $INSTALL_PATH/bin folder,
the libraries in $INSTALL_PATH/lib and the header files in the $INSTALL_PATH/include folder</p>
</div>
<div class="section" id="testing">
<h3>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h3>
<p>We regularly run the DAGMC test suite as part of our continuous integration system, for which we use
<a class="reference external" href="https://travis-ci.org/svalinn/DAGMC">Travis</a>. You may however, wish to run the tests in the
$INSTALL_PATH/tests directory to verify correct installation.  To do this requires
that $INSTALL_PATH/bin be in your PATH and $INSTALL_PATH/lib be in your LD_LIBRARY_PATH:</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; export PATH=$PATH:$INSTALL_PATH/bin
prompt%&gt; export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$INSTALL_PATH/lib
</pre></div>
</div>
<p>Note that this assumes you have previously set the environment variables per the <a class="reference internal" href="#post-install">Post Install</a> section.</p>
<p>With these environment variables you can run fludag_unit_tests:</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; cd $INSTALL_PATH/tests
prompt%&gt; ./fludag_unit_tests
</pre></div>
</div>
<p>With successful execution the last few lines of the screen output will look similar to:</p>
<div class="highlight-python"><div class="highlight"><pre>[       OK ] FluDAGTest.GFireGoodPropStep (5 ms)
[----------] 3 tests from FluDAGTest (108 ms total)

[----------] Global test environment tear-down
[==========] 3 tests from 1 test case ran. (108 ms total)
[  PASSED  ] 3 tests.
</pre></div>
</div>
<p>To run dagsolid_unit_test, in addition to the settings just mentioned, you must also execute
a script that was created at the time geant4 was built:</p>
<div class="highlight-python"><div class="highlight"><pre>prompt%&gt; source path/to/geant4/bld/geant4make.sh
prompt%&gt; cd $INSTALL_PATH/tests
prompt%&gt; ./dagsolid_unit_tests
</pre></div>
</div>
<p>Note that the path to geant4make.sh is different from the path to the geant4 install
directory, defined with -DGEANT4_DIR=path/to/geant4, in the DAGMC compilation examples.</p>
<p>Again, with successful execution the last few lines of screen output are:</p>
<div class="highlight-python"><div class="highlight"><pre>[       OK ] DagSolidTest.surface_area_test (5 ms)
[----------] 16 tests from DagSolidTest (228 ms total)

[----------] Global test environment tear-down
[==========] 16 tests from 1 test case ran. (228 ms total)
[  PASSED  ] 16 tests.
</pre></div>
</div>
<p>With testing successfully completed you are now ready to run your first DAGMC <a class="reference external" href="uw2.html">problem</a>.</p>
</div>
<div class="section" id="dag-tripoli4-access">
<h3>DAG-Tripoli4 Access<a class="headerlink" href="#dag-tripoli4-access" title="Permalink to this headline">¶</a></h3>
<p>Tripoli4 is distributed by CEA/Saclay as a binary executable.  For
access to DAG-Tripoli4, please contact <a class="reference external" href="mailto:jean-christophe&#46;trama&#37;&#52;&#48;cea&#46;fr">Jean-Christophe Trama</a>.</p>
</div>
</div>
</div>


          </div>
      </div>

    </div>
</div>
    <div id="footer">
      <p>
        &copy; Copyright 2012-2015, The UW CNERG Team.
      </p>
      <p>
      Last updated on Nov 09, 2015.
      </p>
      <p>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.
      </p>
    </div>
  </body>
</html>